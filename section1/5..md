[toc]

# 5. Linux進程/服務管理

## 1. Overview

- ==進程== - 通俗來説，就是正在執行的程序or指令
  - 每一個進程都是一個運行實體，占用一定的系統資源 - CPU & Mem （+ Network & Disk）
- 進程管理的作用
  1. 判斷服務器的健康狀態
  2. 查看系統中的所有進程
  3. “殺死”進程

## 2. ps

- `ps` - report a snapshot of the current processes

  ```bash
  # BSD format
  # a - list all processes with a terminal (tty)，or to list all processes when used together with the x option.
  # u - show process run by which user
  # x - list all processes owned by you (same EUID as ps), or to list all processes when used together with the a option.
  ps aux
  
  # USER    - 该进程是由哪个⽤户产⽣的
  # PID     - 进程的ID号
  
  # %CPU    - 该进程占⽤CPU资源的百分⽐
  # %MEM    - 该进程占⽤物理内存的百分⽐
  
  # VSZ     - （運維care）该进程占⽤虚拟内存的，单位KB（Disk中的一部分當作Mem使用 - SWAP）
  # RSS     - （開發care）该进程占⽤物理内存的，单位KB                               
  
  # TTY     - 進程的運行終端
  # 	TTY1-TTY6代表本地控制台终端，TTY1是GUI，TTY2-6是本地的CLI
  # 	PTS/0-255代表虚拟终端，比如ssh；
  #   如果是“？”，则表示该进程是由内核直接产⽣，⽽不是任何的终端产⽣
  
  # STAT    - 进程状态
  #	R - Running    (CPU & Mem keeps changing)
  #	S - Sleeping   (CPU & Mem stay still) - 程序可能進入中斷或者出現問題 or CPU不足，等待其他占用釋放
  #	T - Terminated 
  #   Z - Zombie      脫離了系統的管理，無法被殺死，會一直占用資源
  #	s - subprocess
  #	+ - daemon
  
  # START   - 该进程的启动时间
  # TIME    - 该进程占⽤CPU的运算时间
  
  # COMMAND - 产⽣此进程的命令
  [tutorj@RHEL8-RHCE ~]$ cat
  [root@RHEL8-RHCE tutorj]$ ps aux | grep cat
  USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
  tutorj      8382  0.0  0.0   7460   952 pts/1    S+   20:38   0:00 cat
  
  # 不斷輸出0 - %CPU increased
  [tutorj@RHEL8-RHCE ~]$ cat /dev/zero
  [root@RHEL8-RHCE tutorj]$ ps aux | grep cat
  USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
  tutorj      8625  7.4  0.1   7460  1920 pts/1    S+   20:50   0:00 cat /dev/zero
  
  # 不斷從/dev/zero下產生文件到/dev/null中 - %Mem increased
  [tutorj@RHEL8-RHCE ~]$ dd if=/dev/zero of=/dev/null bs=100MB
  [root@RHEL8-RHCE tutorj]$ ps aux | grep zero
  USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
  tutorj      9236 95.7  5.3 105032 99340 pts/1    R+   20:58   0:16 dd if=/dev/zero of=/dev/null bs=100MB
  
  # cat from local terminal，TTY is tty1 not pts
  [tutorj@RHEL8-RHCE ~]$ cat
  [root@RHEL8-RHCE tutorj]$ ps aux | grep cat
  USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
  tutorj      9693  0.0  0.0   7460   864 tty1     S+   21:06   0:00 cat
  
  # STAT:Ss - crond has subprocess（es）
  [root@RHEL8-RHCE tutorj]$ ps aux | grep gdm
  USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
  root        1498  0.0  0.1  25864  3140 ?        Ss   19:14   0:00 /usr/sbin/crond -n
  ```
  
  ```bash
  # -A - CPU time
  # -e - all processes
  # -f - full format
  ps -A
  ps -e
  ps -ef
  ps -ef
  
  # comomly columes
  # -o - column
  ps -eo pid,ppid,cmd,%mem,%cpu --sort=-%mem | head
  ps -eo pid,ppid,cmd,%mem,%cpu --sort=-%cpu | head
  
  # watch
  watch -n 1 "ps -eo pid,ppid,cmd,%mem,%cpu --sort=-%mem | head"
  watch -n 1 "ps -eo pid,ppid,cmd,%mem,%cpu --sort=-%cpu | head"
  ```

## 3. top

- `top` - display Linux processes (dynamically)

  ```bash
  # set intenval
  top -d <second>
  
  # exit
  q
  
  # Sort by CPU
  P
  
  # Sort by Mem
  M
  
  # Sort byu PID
  N
  ```

  ```bash
  # row#1. uptime, users logged in, load average in 1/5/15min
  top - 04:23:47 up 20 days, 22:34,  2 users,  load average: 1.46, 1.56, 1.46
  
  # row#2. total threads
  Tasks: 227 total,   1 running, 226 sleeping,   0 stopped,   0 zombie
  
  # row#3. CPU state percentages
  # us, user    : time running un-niced user processes
  # sy, system  : time running kernel processes
  # ni, nice    : time running niced user processes
  # id, idle    : time spent in the kernel idle handler
  # wa, IO-wait : time waiting for I/O completion
  # hi          : time spent servicing hardware interrupts
  # si          : time spent servicing software interrupts
  # st          : time stolen from this vm by the hypervisor
  %Cpu(s): 17.7 us, 11.5 sy,  0.0 ni, 70.3 id,  0.0 wa,  0.0 hi,  0.4 si,  0.0 st
  
  # row#4. Memory Usage
  # Pysical
  KiB Mem : 30715236 total,   367120 free, 23598248 used,  6749868 buff/cache
  # Virtual
  KiB Swap:  6143996 total,  6031612 free,   112384 used.  5072552 avail Mem
  
  # Fields
  # PID      Process ID 
  # USER     Process Owner
  # PR       Scheduling Priority of Process
  # NI       Nice Value of Process, negative = higher
  # VIRT     Virtual Memory Size
  # RES      Resident Memory Size
  # SHR      Shared Memory Size
  # S        Process Status
  # %CPU     Process share of the elapsed CPU time since the last screen update
  # %MEM     A process's currently used share of available physical memory
  # TIME+    Total  CPU  time  the task has used since it started
  # COMMAND  Process cmd
  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND
  2475 puppet    20   0 7267860   2.1g  17420 S  61.8  7.2  11496:13 java
  ```

### 1. system load & CPU core

### 2. Mem

## 4. pstree

- `pstree` - display a tree of processes - 直觀父子進程的派生關係

  ```bash
  # -p - show pid -> expand tree
  [root@RHEL8-RHCE tutorj]$ pstree
  systemd─┬─ModemManager───2*[{ModemManager}]
          ├─NetworkManager───2*[{NetworkManager}]
          ├─VBoxDRMClient───3*[{VBoxDRMClient}]
          ├─VBoxService───8*[{VBoxService}]
          ├─3*[abrt-dump-journ]
          ├─abrtd───2*[{abrtd}]
          ├─alsactl
          ├─atd
          ├─auditd─┬─sedispatch
          │        └─2*[{auditd}]
          ├─avahi-daemon───avahi-daemon
          ├─chronyd
          ├─crond
          ├─cupsd
          ├─3*[dbus-daemon───{dbus-daemon}]
          ├─2*[dbus-kill-proce───gio───2*[{gio}]]
          ├─dnsmasq───dnsmasq
          ├─firewalld───{firewalld}
          ├─gssproxy───5*[{gssproxy}]
          ├─2*[gvfsd───2*[{gvfsd}]]
          ├─gvfsd-fuse───5*[{gvfsd-fuse}]
          ├─ksmtuned───sleep
          ├─login───bash
          ├─lsmd
          ├─mcelog
          ├─packagekitd───2*[{packagekitd}]
          ├─pmcd───pmdaroot─┬─pmdadm
          │                 ├─pmdakvm
          │                 ├─pmdalinux
          │                 ├─pmdaproc
          │                 ├─pmdaxfs
          │                 └─2*[python3]
          ├─pmie
          ├─pmlogger
          ├─2*[pmpause]
          ├─polkitd───5*[{polkitd}]
          ├─rhsmcertd
          ├─rpcbind
          ├─rsyslogd───2*[{rsyslogd}]
          ├─rtkit-daemon───2*[{rtkit-daemon}]
          ├─smartd
          ├─sshd─┬─sshd───sshd───bash───sudo───bash───pstree
          │      ├─2*[sshd───sshd───sftp-server]
          │      └─sshd───sshd───bash
          ├─sssd─┬─sssd_be
          │      └─sssd_nss
          ├─stratisd───4*[{stratisd}]
          ├─systemd─┬─(sd-pam)
          │         ├─dbus-daemon───{dbus-daemon}
          │         └─pulseaudio───2*[{pulseaudio}]
          ├─systemd-journal
          ├─systemd-logind
          ├─systemd-machine
          ├─systemd-udevd
          └─tuned───4*[{tuned}]
          
  [root@RHEL8-RHCE tutorj]$ pstree -p | grep bash
             |-login(1513)---bash(9620)
             |-sshd(1200)-+-sshd(4394)---sshd(4413)---bash(4420)---sudo(5857)---bash(5861)-+-grep(11261)
             |            |-sshd(8258)---sshd(8263)---bash(8265)
  ```

## 5. kill

- `kill` - terminate a process by sending signal

  ```bash
  # list process signal
  kill -l
   1) SIGHUP       2) SIGINT       3) SIGQUIT      4) SIGILL       5) SIGTRAP
   6) SIGABRT      7) SIGBUS       8) SIGFPE       9) SIGKILL     10) SIGUSR1
  11) SIGSEGV     12) SIGUSR2     13) SIGPIPE     14) SIGALRM     15) SIGTERM
  16) SIGSTKFLT   17) SIGCHLD     18) SIGCONT     19) SIGSTOP     20) SIGTSTP
  21) SIGTTIN     22) SIGTTOU     23) SIGURG      24) SIGXCPU     25) SIGXFSZ
  26) SIGVTALRM   27) SIGPROF     28) SIGWINCH    29) SIGIO       30) SIGPWR
  31) SIGSYS      34) SIGRTMIN    35) SIGRTMIN+1  36) SIGRTMIN+2  37) SIGRTMIN+3
  38) SIGRTMIN+4  39) SIGRTMIN+5  40) SIGRTMIN+6  41) SIGRTMIN+7  42) SIGRTMIN+8
  43) SIGRTMIN+9  44) SIGRTMIN+10 45) SIGRTMIN+11 46) SIGRTMIN+12 47) SIGRTMIN+13
  48) SIGRTMIN+14 49) SIGRTMIN+15 50) SIGRTMAX-14 51) SIGRTMAX-13 52) SIGRTMAX-12
  53) SIGRTMAX-11 54) SIGRTMAX-10 55) SIGRTMAX-9  56) SIGRTMAX-8  57) SIGRTMAX-7
  58) SIGRTMAX-6  59) SIGRTMAX-5  60) SIGRTMAX-4  61) SIGRTMAX-3  62) SIGRTMAX-2
  63) SIGRTMAX-1  64) SIGRTMAX
  
  # commonly used
  # 1  - SIGHUP  - 使進程立即關閉，重新讀取配置文件后重啓
  # 2  - SIGINT  - 終止前臺進程 = Ctrl + C
  # 9  - SIGKILL - 立即結束進程的運行，該信號不能被阻塞/忽略，常用於强制終止進程
  # 15 - SIGTERM - 正常結束進程，默認信號，如果進程已經發生問題，該信號無法正常終止進程，此時會嘗試SIGKILL
  # 18 - SIGCONT - 使暫停的進程恢復執行，該信號不能被阻斷
  # 19 - SIGSTOP - 暫替前臺進程 = Ctrl + D，不能被阻斷
  
  # kill process process by PID
  kill -9 <PID>
  
  # kill process by name 
  killall <name>
  
  # kill process by name
  pkill -f <name>
  
  # kick user out
  # w - Show who is logged on and what they are doing.
  [root@RHEL8-RHCE tutorj]$ w
   19:56:46 up 11 min,  2 users,  load average: 0.07, 0.13, 0.11
  USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
  tutorj   pts/0    10.0.3.2         19:45    0.00s  0.13s  0.05s sshd: tutorj [priv]
  tutorj   pts/1    10.0.3.2         19:53    2:55   0.05s  0.05s -bash
  # t - terminal
  [root@RHEL8-RHCE tutorj]$ pkill -t pts/1
  [root@RHEL8-RHCE tutorj]$ w
   19:58:12 up 12 min,  1 user,  load average: 0.01, 0.09, 0.10
  USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
  tutorj   pts/0    10.0.3.2         19:45    4.00s  0.11s  0.05s sshd: tutorj [priv]
  ```

## 6. Job Scheduling

- 作業的本質仍然是進程，以shell為單位，一個shell建立的作業，不會被另一個shell看到（包括root），但仍然能看到作業對應的進程

  

- `Frontground Process` - ==前臺進程== - 運行在用戶眼前的進程，如果用戶想運行其他進程，必須關閉當前前臺進程，或將前臺進程放到後臺運行

  - `Ctrl + C` - 停止該進程
  - `Ctrl + Z` - 放到後臺運行，該進程狀態變爲`Stopped`，恢復需要使用`kill`發送繼續運行的信號（18）

- `Background Process`  - ==後臺進程== - 不會影響用戶當前shell其他進程，**并非所有進程都可以運行在後臺**（top）

  - 適合後臺運行
    - 運行時間長，用戶不想在前臺等待，前提是該進程可以結束
    - 服務進程，用戶想讓其永遠讓其處於運行狀態

  ```bash
  # put process to background - daemonize
  <cmd> &
  
  # [jobId] PID
  [root@RHEL8-RHCE tutorj]$ cat &
  [1] 6060
  [root@RHEL8-RHCE tutorj]$ ps aux | grep 6060
  USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
  root        6060  0.0  0.0   7460   892 pts/0    T    20:15   0:00 cat
  
  # list job in current shell
  # it cannot be seen by other shells
  [root@RHEL8-RHCE tutorj]$ jobs
  [1]+  Stopped                 cat
  [tutorj@RHEL8-RHCE ~]$ jobs
  [tutorj@RHEL8-RHCE ~]$
  ```

  

- jobs管理後臺進程 - 本質也是通過kill給後臺進程發送信號

  ```bash
  [root@RHEL8-RHCE tutorj]$ cat &
  [2] 6226
  [root@RHEL8-RHCE tutorj]$ ps aux | grep 6226
  USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
  root        6226  0.0  0.0   7460   860 pts/0    T    20:22   0:00 cat
  
  # kill backgroud process + %
  kill %<jobID>
  
  [root@RHEL8-RHCE tutorj]$ kill %2
  [2]+  Stopped                 cat
  [root@RHEL8-RHCE tutorj]$ jobs
  [1]-  Stopped                 cat
  [2]+  Terminated              cat
  
  # send with signal resume stoped process
  kill -18 %<jobID>
  
  # put job to back/front
  bg %<jobID>
  fg %<jobID>
  ```

  

- `Priority` 

  - X CPU Core - 最大允許有X個進程同時使用100%CPU

    ```bash
    # display information about the CPU architecture
    lscpu
    
    [root@RHEL8-RHCE tutorj]$ lscpu
    Architecture:        x86_64
    CPU op-mode(s):      32-bit, 64-bit
    Byte Order:          Little Endian
    CPU(s):              1
    On-line CPU(s) list: 0
    Thread(s) per core:  1
    Core(s) per socket:  1
    Socket(s):           1
    NUMA node(s):        1
    Vendor ID:           GenuineIntel
    CPU family:          6
    Model:               142
    Model name:          Intel(R) Core(TM) i5-8265U CPU @ 1.60GHz
    Stepping:            11
    CPU MHz:             1800.001
    BogoMIPS:            3600.00
    Hypervisor vendor:   KVM
    Virtualization type: full
    L1d cache:           32K
    L1i cache:           32K
    L2 cache:            256K
    L3 cache:            6144K
    NUMA node0 CPU(s):   0
    Flags:               fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ht syscall nx rdtscp lm constant_tsc rep_good nopl xtopology nonstop_tsc cpuid tsc_known_freq pni pclmulqdq monitor ssse3 cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt aes xsave avx rdrand hypervisor lahf_lm abm 3dnowprefetch invpcid_single fsgsbase bmi1 avx2 bmi2 invpcid rdseed clflushopt md_clear flush_l1d arch_capabilities
    ```

    

  - **假如有X+1個進程需要運行，且都需要占用100%CPU，可以通過調整進程的優先級來使其更快速地結束**

    

  - `nice` - run a program with modified scheduling priority，PR越大 = NI越大，越不容易分配到CPU

    - PR最小值為0；NI最小值為-20 -> PR - NI = 20

    ```bash
    [root@RHEL8-RHCE tutorj]$ cat /dev/zero >> /dev/null &
    [1] 7371
    [root@RHEL8-RHCE tutorj]$ cat /dev/zero >> /dev/null &
    [2] 7384
    
    # only have 1 CPU, two cmds share since they have the same PR - Priority = 20
    [root@RHEL8-RHCE tutorj]$ top 1
    PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND
    7371 root      20   0    7460   1972   1744 R  49.0   0.1   0:11.69 cat
    7384 root      20   0    7460   2024   1792 R  48.3   0.1   0:01.71 cat
    
    
    # set nice for 2nd
    # PR - NI = 20
    # if set NI = 10, then PR will be 30
    [root@RHEL8-RHCE tutorj]$ cat /dev/zero >> /dev/null &
    [1] 7473
    [root@RHEL8-RHCE tutorj]$ nice -10 cat /dev/zero >> /dev/null &
    [2] 7488
    [root@RHEL8-RHCE tutorj]$ top 1
    PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND
    7473 root      20   0    7460   2028   1804 R  88.4   0.1   0:45.39 cat
    7488 root      30  10    7460   2020   1804 R   9.6   0.1   0:01.72 cat
    ```

  - `renice` - alter priority of running processes

    ```bash
    [root@RHEL8-RHCE tutorj]$ renice -n -10 7473
    7473 (process ID) old priority 10, new priority -10
    
    
    [root@RHEL8-RHCE tutorj]$ top 1
    PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND
    7473 root      10 -10    7460   2028   1804 R  96.0   0.1  11:14.00 cat
    7488 root      30  10    7460   2020   1804 R   1.0   0.1   2:54.39 cat
    ```

## 7. Service

- 服務是進程，進程不一定是服務

- **服務是具備一定功能的進程**，但有些進程并不具備服務的特徵

- 服務可以通過此前的進程管理命令進行操作

  

- **The 1st process of Linux**

  - 第一个进程负责后续进程的启动，后续进程能否成功却决于系统是否能正常运作
  - Before RHEL6 - `SystemV init`
    - 串行启动后续进程，速度慢
- Since RHEL7 - `systemd`
  
    - 并行启动后续进程，速度快（先进内存再说，然后再监控依赖，如果依赖就绪，就能立刻启动）



- `sytemctl` - Control the systemd system and service manager

  - 管理单位`unit`，`service`只是其中的一种

  ```bash
  # list units
  # .device
  # .mount
  # .path
  # .scope
  # .service (*)
  # .slice
  # .socket (*)
  # .swap
  # .target (*)
  # .timer
  [root@RHEL8-RHCE tutorj]$ systemctl list-units
  
  # check unit state
  [root@RHEL8-RHCE tutorj]$ systemctl list-unit-files
  ```

  ```bash
  # check service unit status
  [root@RHEL8-RHCE tutorj]$ systemctl status NetworkManager
  ● NetworkManager.service - Network Manager
     Loaded: loaded (/usr/lib/systemd/system/NetworkManager.service; enabled; vendor preset: enabled)
     Active: active (running) since Thu 2023-01-19 19:41:21 CST; 30min ago
       Docs: man:NetworkManager(8)
   Main PID: 1191 (NetworkManager)
      Tasks: 3 (limit: 11224)
     Memory: 8.0M
     CGroup: /system.slice/NetworkManager.service
             └─1191 /usr/sbin/NetworkManager --no-daemon
  
  # check service unit file
  [root@RHEL8-RHCE tutorj]$ cat /usr/lib/systemd/system/NetworkManager.service
  [Unit]
  Description=Network Manager
  Documentation=man:NetworkManager(8)
  Wants=network.target                    # dependency
  After=network-pre.target dbus.service
  Before=network.target network.service
  
  [Service]
  Type=dbus
  BusName=org.freedesktop.NetworkManager
  ExecReload=/usr/bin/busctl call org.freedesktop.NetworkManager /org/freedesktop/NetworkManager org.freedesktop.NetworkManager Reload u 0
  #ExecReload=/bin/kill -HUP $MAINPID
  ExecStart=/usr/sbin/NetworkManager --no-daemon
  Restart=on-failure
  # NM doesn't want systemd to kill its children for it
  KillMode=process
  
  # CAP_DAC_OVERRIDE: required to open /run/openvswitch/db.sock socket.
  CapabilityBoundingSet=CAP_NET_ADMIN CAP_DAC_OVERRIDE CAP_NET_RAW CAP_NET_BIND_SERVICE CAP_SETGID CAP_SETUID CAP_SYS_MODULE CAP_AUDIT_WRITE CAP_KILL CAP_SYS_CHROOT
  
  ProtectSystem=true
  ProtectHome=read-only
  
  # We require file descriptors for DHCP etc. When activating many interfaces,
  # the default limit of 1024 is easily reached.
  LimitNOFILE=65536
  
  [Install]
  WantedBy=multi-user.target
  Also=NetworkManager-dispatcher.service
  
  # We want to enable NetworkManager-wait-online.service whenever this service
  # is enabled. NetworkManager-wait-online.service has
  # WantedBy=network-online.target, so enabling it only has an effect if
  # network-online.target itself is enabled or pulled in by some other unit.
  Also=NetworkManager-wait-online.service
  
  
  # stop service unit
  [root@RHEL8-RHCE tutorj]$ systemctl stop NetworkManager
  [root@RHEL8-RHCE tutorj]$ systemctl status NetworkManager
  ● NetworkManager.service - Network Manager
     Loaded: loaded (/usr/lib/systemd/system/NetworkManager.service; enabled; vendor preset: enabled)
     Active: inactive (dead) since Thu 2023-01-19 20:15:58 CST; 6s ago
       Docs: man:NetworkManager(8)
    Process: 1191 ExecStart=/usr/sbin/NetworkManager --no-daemon (code=exited, status=0/SUCCESS)
   Main PID: 1191 (code=exited, status=0/SUCCESS)
  
  
  # start service unit
  [root@RHEL8-RHCE tutorj]$ systemctl start NetworkManager
  [root@RHEL8-RHCE tutorj]$ systemctl status NetworkManager
  ● NetworkManager.service - Network Manager
     Loaded: loaded (/usr/lib/systemd/system/NetworkManager.service; enabled; vendor preset: enabled)
     Active: active (running) since Thu 2023-01-19 20:16:37 CST; 955ms ago
       Docs: man:NetworkManager(8)
   Main PID: 6004 (NetworkManager)
      Tasks: 4 (limit: 11224)
     Memory: 3.8M
     CGroup: /system.slice/NetworkManager.service
             └─6004 /usr/sbin/NetworkManager --no-daemon
             
  # restart service unit
  [root@RHEL8-RHCE tutorj]$ systemctl restart NetworkManager
  [root@RHEL8-RHCE tutorj]$ systemctl status NetworkManager
  ● NetworkManager.service - Network Manager
     Loaded: loaded (/usr/lib/systemd/system/NetworkManager.service; enabled; vendor preset: enabled)
     Active: active (running) since Thu 2023-01-19 20:17:13 CST; 949ms ago
       Docs: man:NetworkManager(8)
   Main PID: 6109 (NetworkManager)
      Tasks: 4 (limit: 11224)
     Memory: 3.9M
     CGroup: /system.slice/NetworkManager.service
             └─6109 /usr/sbin/NetworkManager --no-daemon
             
  # disable/enable auto when boot - using soft link
  [root@RHEL8-RHCE tutorj]$ systemctl disable NetworkManager
  Removed /etc/systemd/system/multi-user.target.wants/NetworkManager.service.
  Removed /etc/systemd/system/dbus-org.freedesktop.nm-dispatcher.service.
  Removed /etc/systemd/system/network-online.target.wants/NetworkManager-wait-online.service.
  [root@RHEL8-RHCE tutorj]$ systemctl status NetworkManager
  ● NetworkManager.service - Network Manager
     Loaded: loaded (/usr/lib/systemd/system/NetworkManager.service; disabled; vendor preset: enabled)
     Active: active (running) since Thu 2023-01-19 20:17:13 CST; 1min 53s ago
       Docs: man:NetworkManager(8)
   Main PID: 6109 (NetworkManager)
      Tasks: 3 (limit: 11224)
     Memory: 3.8M
     CGroup: /system.slice/NetworkManager.service
             └─6109 /usr/sbin/NetworkManager --no-daemon
  
  [root@RHEL8-RHCE tutorj]$ systemctl enable NetworkManager
  Created symlink /etc/systemd/system/multi-user.target.wants/NetworkManager.service → /usr/lib/systemd/system/NetworkManager.service.
  Created symlink /etc/systemd/system/dbus-org.freedesktop.nm-dispatcher.service → /usr/lib/systemd/system/NetworkManager-dispatcher.service.
  Created symlink /etc/systemd/system/network-online.target.wants/NetworkManager-wait-online.service → /usr/lib/systemd/system/NetworkManager-wait-online.service.
  [root@RHEL8-RHCE tutorj]$ systemctl status NetworkManager
  ● NetworkManager.service - Network Manager
     Loaded: loaded (/usr/lib/systemd/system/NetworkManager.service; enabled; vendor preset: enabled)
     Active: active (running) since Thu 2023-01-19 20:17:13 CST; 2min 7s ago
       Docs: man:NetworkManager(8)
   Main PID: 6109 (NetworkManager)
      Tasks: 3 (limit: 11224)
     Memory: 3.9M
     CGroup: /system.slice/NetworkManager.service
             └─6109 /usr/sbin/NetworkManager --no-daemon
  
  # check if service unit is active
  [root@RHEL8-RHCE tutorj]$ systemctl is-active NetworkManager
  active
  
  # check if service unit has auto start 
  [root@RHEL8-RHCE tutorj]$ systemctl is-enabled NetworkManager
  enabled
  ```

- `systemd` - systemd system and service manager

  - `target` - a collectioon of services
  - `multi-user.target` - CLI
    - `graphical.target`  - GUI

  ```bash
  # switch to GUI temporarily
  [root@RHEL8-RHCE tutorj]$ systemctl isolate graphical.target
  # switch tty1-6, tty1 is GUI, tty2~6 is CLI
  Ctrl + Alt + F1~F6

  # switch to CLI temporarily
  [root@RHEL8-RHCE tutorj]$ systemctl isolate multi-user.target

  # check default target
  [root@RHEL8-RHCE tutorj]$ systemctl get-default

  # set default target
  [root@RHEL8-RHCE tutorj]$ systemctl set-default multi-user.target
  [root@RHEL8-RHCE tutorj]$ systemctl set-default graphical.target      # 前提是安装了GUI软件包！！！

  # Reload the systemd manager configuration. This will rerun all generators (see systemd.generator(7)), 
  # reload all unit files, and recreate the entire dependency tree. 
  # While the daemon is being reloaded, all sockets systemd listens on behalf of user configuration will stay accessible.
  systemctl daemon-reload
  ```

## Extra

> 理念：只要是进程和服务就会占用一定的系统资源 - CPU/Mem/Disk/Network；通过监控资源来判断进程和服务的状态

### 1. 单机监控常见资源查看

- CPU

  ```bash
  [root@RHEL8-RHCE devices]# cd /sys/devices/system/cpu/
  cpu0/            cpufreq/         cpuidle/         hotplug/         power/           smt/             vulnerabilities/
  
  [root@RHEL8-RHCE tutorj]# lscpu
  Architecture:        x86_64
  CPU op-mode(s):      32-bit, 64-bit
  Byte Order:          Little Endian
  CPU(s):              1
  On-line CPU(s) list: 0
  Thread(s) per core:  1
  Core(s) per socket:  1
  Socket(s):           1
  NUMA node(s):        1 
  Vendor ID:           GenuineIntel
  CPU family:          6
  Model:               142
  Model name:          Intel(R) Core(TM) i5-8265U CPU @ 1.60GHz
  Stepping:            11
  CPU MHz:             1800.001
  BogoMIPS:            3600.00
  Hypervisor vendor:   KVM
  Virtualization type: full
  L1d cache:           32K
  L1i cache:           32K
  L2 cache:            256K
  L3 cache:            6144K
  NUMA node0 CPU(s):   0
  Flags:               fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ht syscall nx rdtscp lm constant_tsc rep_good nopl xtopology nonstop_tsc cpuid tsc_known_freq pni pclmulqdq monitor ssse3 cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt aes xsave avx rdrand hypervisor lahf_lm abm 3dnowprefetch invpcid_single fsgsbase bmi1 avx2 bmi2 invpcid rdseed clflushopt md_clear flush_l1d arch_capabilities
  
  # 列出所有CPU线程
  [root@RHEL8-RHCE tutorj]# cat /proc/cpuinfo
  processor       : 0
  vendor_id       : GenuineIntel
  cpu family      : 6
  model           : 142
  model name      : Intel(R) Core(TM) i5-8265U CPU @ 1.60GHz
  stepping        : 11
  cpu MHz         : 1800.001
  cache size      : 6144 KB
  physical id     : 0
  siblings        : 1
  core id         : 0
  cpu cores       : 1
  apicid          : 0
  initial apicid  : 0
  fpu             : yes
  fpu_exception   : yes
  cpuid level     : 22
  wp              : yes
  flags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ht syscall nx rdtscp lm constant_tsc rep_good nopl xtopology nonstop_tsc cpuid tsc_known_freq pni pclmulqdq monitor ssse3 cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt aes xsave avx rdrand hypervisor lahf_lm abm 3dnowprefetch invpcid_single fsgsbase bmi1 avx2 bmi2 invpcid rdseed clflushopt md_clear flush_l1d arch_capabilities
  bugs            : spectre_v1 spectre_v2 spec_store_bypass mds swapgs itlb_multihit srbds mmio_stale_data retbleed
  bogomips        : 3600.00
  clflush size    : 64
  cache_alignment : 64
  address sizes   : 39 bits physical, 48 bits virtual
  power management:
  
  # 动态查看进程CPU
  top
  
  # top with color
  # epel repo
  yum -y install htop
  htop
  
  # system load
  [root@RHEL8-RHCE cpu]# w
   10:33:22 up  1:47,  2 users,  load average: 0.00, 0.01, 0.00
  USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
  tutorj   pts/0    10.0.3.2         08:45   17:25   0.45s  0.05s sshd: tutorj [priv]
  tutorj   pts/1    10.0.3.2         09:31    1.00s  0.43s  0.04s sshd: tutorj [priv]
  
  [root@RHEL8-RHCE cpu]# uptime
   10:33:40 up  1:48,  2 users,  load average: 0.00, 0.01, 0.00
  ```

- Mem

  ```bash
  # 将内存以块存储的形式
  [root@RHEL8-RHCE cpu]# cd /sys/devices/system/memory/
  memory0/  memory10/ memory12/ memory14/ memory2/  memory4/  memory6/  memory8/  power/
  memory1/  memory11/ memory13/ memory15/ memory3/  memory5/  memory7/  memory9/
  [root@RHEL8-RHCE memory0]# tree
  .
  ├── node0 -> ../../node/node0
  ├── online
  ├── phys_device
  ├── phys_index
  ├── power
  │   ├── autosuspend_delay_ms
  │   ├── control
  │   ├── runtime_active_time
  │   ├── runtime_status
  │   └── runtime_suspended_time
  ├── removable
  ├── state
  ├── subsystem -> ../../../../bus/memory
  ├── uevent
  └── valid_zones
  
  [root@RHEL8-RHCE tutorj]# free -h
                total        used        free      shared  buff/cache   available
  Mem:          1.8Gi       411Mi       344Mi       1.0Mi       1.0Gi       1.2Gi
  Swap:         1.5Gi          0B       1.5Gi
  ```

- Disk

  ```bash
  [root@RHEL8-RHCE cpu]# fdisk -l
  Disk /dev/sda: 15 GiB, 16106127360 bytes, 31457280 sectors
  Units: sectors of 1 * 512 = 512 bytes
  Sector size (logical/physical): 512 bytes / 512 bytes
  I/O size (minimum/optimal): 512 bytes / 512 bytes
  Disklabel type: dos
  Disk identifier: 0xfecd8079
  
  Device     Boot   Start      End  Sectors Size Id Type
  /dev/sda1  *       2048  2099199  2097152   1G 83 Linux
  /dev/sda2       2099200 31457279 29358080  14G 8e Linux LVM
  
  
  Disk /dev/sdb: 10 GiB, 10737418240 bytes, 20971520 sectors
  Units: sectors of 1 * 512 = 512 bytes
  Sector size (logical/physical): 512 bytes / 512 bytes
  I/O size (minimum/optimal): 512 bytes / 512 bytes
  
  
  Disk /dev/mapper/rhel-root: 12.5 GiB, 13417578496 bytes, 26206208 sectors
  Units: sectors of 1 * 512 = 512 bytes
  Sector size (logical/physical): 512 bytes / 512 bytes
  I/O size (minimum/optimal): 512 bytes / 512 bytes
  
  
  Disk /dev/mapper/rhel-swap: 1.5 GiB, 1610612736 bytes, 3145728 sectors
  Units: sectors of 1 * 512 = 512 bytes
  Sector size (logical/physical): 512 bytes / 512 bytes
  I/O size (minimum/optimal): 512 bytes / 512 bytes
  
  [root@RHEL8-RHCE cpu]# df -Th
  Filesystem            Type      Size  Used Avail Use% Mounted on
  devtmpfs              devtmpfs  877M     0  877M   0% /dev
  tmpfs                 tmpfs     907M     0  907M   0% /dev/shm
  tmpfs                 tmpfs     907M  996K  906M   1% /run
  tmpfs                 tmpfs     907M     0  907M   0% /sys/fs/cgroup
  /dev/mapper/rhel-root xfs        13G  7.9G  4.6G  64% /
  /dev/sda1             xfs      1014M  342M  673M  34% /boot
  tmpfs                 tmpfs     1.0M     0  1.0M   0% /run/stratisd/keyfiles
  tmpfs                 tmpfs     182M  4.0K  182M   1% /run/user/1000
  
  [root@RHEL8-RHCE cpu]# df -i
  Filesystem             Inodes  IUsed   IFree IUse% Mounted on
  devtmpfs               224505    389  224116    1% /dev
  tmpfs                  232030      1  232029    1% /dev/shm
  tmpfs                  232030    736  231294    1% /run
  tmpfs                  232030     17  232013    1% /sys/fs/cgroup
  /dev/mapper/rhel-root 6551552 201868 6349684    4% /
  /dev/sda1              524288    317  523971    1% /boot
  tmpfs                  232030      1  232029    1% /run/stratisd/keyfiles
  tmpfs                  232030     12  232018    1% /run/user/1000
  
  [root@RHEL8-RHCE cpu]# blkid
  /dev/sda1: UUID="ce024b35-079e-4c13-b285-63cfbd06fae3" BLOCK_SIZE="512" TYPE="xfs" PARTUUID="fecd8079-01"
  /dev/sda2: UUID="JWcK1C-F71Z-6MjS-TzWG-nhfP-OHP8-RiXjEr" TYPE="LVM2_member" PARTUUID="fecd8079-02"
  /dev/sr0: BLOCK_SIZE="2048" UUID="2022-11-16-17-05-17-10" LABEL="VBox_GAs_7.0.4" TYPE="iso9660"
  /dev/mapper/rhel-root: UUID="6b0f033e-83c4-42e9-8ca3-45f1e4544419" BLOCK_SIZE="512" TYPE="xfs"
  /dev/mapper/rhel-swap: UUID="f9071724-7400-4b06-88bd-fcb6f58840ff" TYPE="swap"
  ```

- NIC

  ```bash
  [root@RHEL8-RHCE cpu]# ethtool enp0s3
  Settings for enp0s3:
          Supported ports: [ TP ]
          Supported link modes:   10baseT/Half 10baseT/Full
                                  100baseT/Half 100baseT/Full
                                  1000baseT/Full
          Supported pause frame use: No
          Supports auto-negotiation: Yes
          Supported FEC modes: Not reported
          Advertised link modes:  10baseT/Half 10baseT/Full
                                  100baseT/Half 100baseT/Full
                                  1000baseT/Full
          Advertised pause frame use: No
          Advertised auto-negotiation: Yes
          Advertised FEC modes: Not reported
          Speed: 1000Mb/s
          Duplex: Full
          Auto-negotiation: on
          Port: Twisted Pair
          PHYAD: 0
          Transceiver: internal
          MDI-X: off (auto)
          Supports Wake-on: umbg
          Wake-on: d
          Current message level: 0x00000007 (7)
                                 drv probe link
          Link detected: yes
  
  
  [root@RHEL8-RHCE cpu]# ip a
  1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
      link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
      inet 127.0.0.1/8 scope host lo
         valid_lft forever preferred_lft forever
      inet6 ::1/128 scope host
         valid_lft forever preferred_lft forever
  2: enp0s3: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
      link/ether 08:00:27:da:e6:57 brd ff:ff:ff:ff:ff:ff
      inet 10.0.3.4/24 brd 10.0.3.255 scope global dynamic noprefixroute enp0s3
         valid_lft 331sec preferred_lft 331sec
      inet6 fe80::a00:27ff:feda:e657/64 scope link noprefixroute
         valid_lft forever preferred_lft forever
  3: enp0s8: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
      link/ether 08:00:27:54:ce:27 brd ff:ff:ff:ff:ff:ff
      inet 192.168.56.3/32 scope global noprefixroute enp0s8
         valid_lft forever preferred_lft forever
      inet6 fe80::9c99:2a33:423:f7f8/64 scope link noprefixroute
         valid_lft forever preferred_lft forever
  4: virbr0: <NO-CARRIER,BROADCAST,MULTICAST,UP> mtu 1500 qdisc noqueue state DOWN group default qlen 1000
      link/ether 52:54:00:c7:8f:ea brd ff:ff:ff:ff:ff:ff
      inet 192.168.122.1/24 brd 192.168.122.255 scope global virbr0
         valid_lft forever preferred_lft forever
         
         
  [root@RHEL8-RHCE cpu]# ifconfig
  enp0s3: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
          inet 10.0.3.4  netmask 255.255.255.0  broadcast 10.0.3.255
          inet6 fe80::a00:27ff:feda:e657  prefixlen 64  scopeid 0x20<link>
          ether 08:00:27:da:e6:57  txqueuelen 1000  (Ethernet)
          RX packets 6300  bytes 2840299 (2.7 MiB)
          RX errors 0  dropped 0  overruns 0  frame 0
          TX packets 4732  bytes 573607 (560.1 KiB)
          TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
  
  enp0s8: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
          inet 192.168.56.3  netmask 255.255.255.255  broadcast 0.0.0.0
          inet6 fe80::9c99:2a33:423:f7f8  prefixlen 64  scopeid 0x20<link>
          ether 08:00:27:54:ce:27  txqueuelen 1000  (Ethernet)
          RX packets 36  bytes 5123 (5.0 KiB)
          RX errors 0  dropped 0  overruns 0  frame 0
          TX packets 32  bytes 3602 (3.5 KiB)
          TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
  
  lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
          inet 127.0.0.1  netmask 255.0.0.0
          inet6 ::1  prefixlen 128  scopeid 0x10<host>
          loop  txqueuelen 1000  (Local Loopback)
          RX packets 1533  bytes 902003 (880.8 KiB)
          RX errors 0  dropped 0  overruns 0  frame 0
          TX packets 1533  bytes 902003 (880.8 KiB)
          TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
  
  virbr0: flags=4099<UP,BROADCAST,MULTICAST>  mtu 1500
          inet 192.168.122.1  netmask 255.255.255.0  broadcast 192.168.122.255
          ether 52:54:00:c7:8f:ea  txqueuelen 1000  (Ethernet)
          RX packets 0  bytes 0 (0.0 B)
          RX errors 0  dropped 0  overruns 0  frame 0
          TX packets 0  bytes 0 (0.0 B)
          TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
  
  ```

### 2. 单机监控扩展资源查看

- NIC动态流量

  ```bash
  # 1. epel repo
  # 2. yum -y install iftop
  
  # -i - interface
  # -n - not resolve host
  [root@RHEL8-RHCE tutorj]# iftop -i enp0s3
  interface: enp0s3
  IP address is: 10.0.3.4
  MAC address is: 08:00:27:da:e6:57
  
  # ifstat - handy utility to read network interface statistics
  [root@RHEL8-RHCE tutorj]# ifstat
  #kernel
  Interface        RX Pkts/Rate    TX Pkts/Rate    RX Data/Rate    TX Data/Rate
                   RX Errs/Drop    TX Errs/Drop    RX Over/Rate    TX Coll/Rate
  lo                     0 0             0 0             0 0             0 0
                         0 0             0 0             0 0             0 0
  enp0s3                 4 0             4 0           324 0           440 0
                         0 0             0 0             0 0             0 0
  enp0s8                 0 0             0 0             0 0             0 0
                         0 0             0 0             0 0             0 0
  virbr0                 0 0             0 0             0 0             0 0
                         0 0             0 0             0 0             0 0
                         
  [root@RHEL8-RHCE tutorj]# ifconfig enp0s3
  enp0s3: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
          inet 10.0.3.4  netmask 255.255.255.0  broadcast 10.0.3.255
          inet6 fe80::a00:27ff:feda:e657  prefixlen 64  scopeid 0x20<link>
          ether 08:00:27:da:e6:57  txqueuelen 1000  (Ethernet)
          RX packets 7220  bytes 3041722 (2.9 MiB)      # received
          RX errors 0  dropped 0  overruns 0  frame 0  
          TX packets 5492  bytes 681057 (665.0 KiB)     # sent
          TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
  ```

- Disk IO

  - 速度排序：ALU -> L1 -> L2 -> L3 -> 热点Mem -> 通用Mem -> Disk -> NIC

  ```bash
  # 1. base repo
  # 2. yum -y install iotop
  
  [root@RHEL8-RHCE tutorj]# dd if=/dev/zero of=/root/1G
  ^C906985+0 records in
  906985+0 records out
  464376320 bytes (464 MB, 443 MiB) copied, 11.0946 s, 41.9 MB/s
  
  [root@RHEL8-RHCE tutorj]# iotop
  Total DISK READ :      89.49 K/s | Total DISK WRITE :       3.98 M/s
  Actual DISK READ:      82.81 K/s | Actual DISK WRITE:       6.01 M/s
      TID  PRIO  USER     DISK READ DISK WRITE>    COMMAND
    13443 be/4 root        0.00 B/s    3.98 M/s dd if=/dev/zero of=/root/1G
        1 be/4 root        0.00 B/s    0.00 B/s systemd --switched-root --system --deserialize 17
        2 be/4 root        0.00 B/s    0.00 B/s [kthreadd]
  ```

- `dmidecode` - 适用于服务器裸机安装Linux，服务器的操作系统就是Linux，而不是将其作为Hypervisor于上面部署VM

  - ==资产管理== - 确认服务器的型号/序列号/CPU/内存....

  ```bash
  # 服务器型号
  [root@RHEL8-RHCE tutorj]# dmidecode | grep 'Product Name'
          Product Name: VirtualBox
          Product Name: VirtualBox
  
  # 主板序列号
  [root@RHEL8-RHCE tutorj]# dmidecode | grep 'Serial Number'
          Serial Number: 0
          Serial Number: 0
          Serial Number: Not Specified
  
  # 系统序列列好
  [root@RHEL8-RHCE tutorj]# dmidecode -s system-serial-number
  0
  
  # 查看内存型号
  [root@RHEL8-RHCE tutorj]# dmidecode -t memory
  # dmidecode 3.3
  Getting SMBIOS data from sysfs.
  SMBIOS 2.5 present.
  
  # 内存容量和大小
  [root@RHEL8-RHCE tutorj]# dmidecode | grep -A16 "Memory Device" | grep "Size" | sed 's/^[ \t]*//'
  
  # 最搭支持内存容量
  [root@RHEL8-RHCE tutorj]# dmidecode | grep -A16 "Maximum Capacity" | sed 's/^[ \t]*//'
  ```

- hardware

  ```bash
  # 内存信息
  [root@RHEL8-RHCE tutorj]# cat /proc/meminfo | head
  MemTotal:        1856240 kB
  MemFree:          327164 kB
  MemAvailable:     936188 kB
  Buffers:            2120 kB
  Cached:           699744 kB
  SwapCached:          528 kB
  Active:           512508 kB
  Inactive:         760448 kB
  Active(anon):       6568 kB
  Inactive(anon):   565928 kB
  
  # 网卡信息
  # enp0s3 -> ethernet p0 + s3
  # p       0 s3
  # pci@0000:00:03.0
  [root@RHEL8-RHCE tutorj]# lshw -class net -businfo
  Bus info          Device      Class       Description
  =====================================================
  pci@0000:00:03.0  enp0s3      network     82540EM Gigabit Ethernet Controller
  pci@0000:00:08.0  enp0s8      network     82540EM Gigabit Ethernet Controller
  
  
  # 硬盘信息 - 裸机
  [root@RHEL8-RHCE tutorj]# smartctl -a /dev/sda
  smartctl 7.1 2020-04-05 r5049 [x86_64-linux-4.18.0-425.3.1.el8.x86_64] (local build)
  Copyright (C) 2002-19, Bruce Allen, Christian Franke, www.smartmontools.org
  
  === START OF INFORMATION SECTION ===
  Device Model:     VBOX HARDDISK
  Serial Number:    VB1147f8e7-4f0f9470
  Firmware Version: 1.0
  User Capacity:    16,106,127,360 bytes [16.1 GB]
  Sector Size:      512 bytes logical/physical
  Device is:        Not in smartctl database [for details use: -P showall]
  ATA Version is:   ATA/ATAPI-6 published, ANSI INCITS 361-2002
  Local Time is:    Sat Jan 21 14:08:49 2023 CST
  SMART support is: Unavailable - device lacks SMART capability.
  
  [root@RHEL8-RHCE tutorj]# hdparm -i /dev/sda
  
  /dev/sda:
  
   Model=VBOX HARDDISK, FwRev=1.0, SerialNo=VB1147f8e7-4f0f9470
   Config={ Fixed }
   RawCHS=16383/16/63, TrkSize=0, SectSize=512, ECCbytes=0
   BuffType=DualPortCache, BuffSize=256kB, MaxMultSect=128, MultSect=128
   CurCHS=16383/16/63, CurSects=16514064, LBA=yes, LBAsects=31457280
   IORDY=yes, tPIO={min:120,w/IORDY:120}, tDMA={min:120,rec:120}
   PIO modes:  pio0 pio3 pio4
   DMA modes:  mdma0 mdma1 mdma2
   UDMA modes: udma0 udma1 udma2 udma3 udma4 udma5 *udma6
   AdvancedPM=no WriteCache=enabled
   Drive conforms to: unknown:  ATA/ATAPI-1,2,3,4,5,6
  ```

### 3. systemd service DIY

### 4. ls* (TODO)

- `lsof` - 
- `lslogin` - 
- `lspci` - 
- `lshw` - 